Python reference implementation and Solidity contract implementation